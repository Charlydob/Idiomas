<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  <meta name="theme-color" content="#0f1115" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="Deutsch Coach" />
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" sizes="192x192" href="icons/icon-192.png" />
  <link rel="icon" sizes="512x512" href="icons/icon-512.png" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
  <title>Deutsch Coach ‚Äî Frases & Repaso</title>
  <link rel="stylesheet" href="app.css" />

  <!-- Firebase compat (no ESM) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-storage-compat.js"></script>
</head>
<body>
  <div id="app" class="app-shell">
    <!-- TOP APP BAR -->
    <header class="topbar" role="banner">
      <div class="brand">
        <span class="brand-mark" aria-hidden="true">üúÅ</span>
        <span class="brand-name">Deutsch Coach</span>
      </div>

      <div class="topbar-actions">
        <button id="btnSettings" class="icon-btn" title="Ajustes" aria-haspopup="dialog" aria-controls="settingsDialog">‚öôÔ∏è</button>
      </div>
    </header>

    <!-- PRIMARY TABS -->
    <nav class="tabs primary" role="tablist" aria-label="Secciones">
      <button class="tab active" role="tab" aria-selected="true" aria-controls="tab-import" id="tab-import-btn" data-tab="import">Importar</button>
      <button class="tab" role="tab" aria-selected="false" aria-controls="tab-frases" id="tab-frases-btn" data-tab="frases">Frases</button>
      <button class="tab" role="tab" aria-selected="false" aria-controls="tab-vocab" id="tab-vocab-btn" data-tab="vocab">Vocab</button>
      <button class="tab" role="tab" aria-selected="false" aria-controls="tab-repaso" id="tab-repaso-btn" data-tab="repaso">Repaso</button>
    </nav>

    <!-- CONTENT AREA -->
    <main class="screen content" role="main">
      <!-- IMPORTAR -->
      <section id="tab-import" class="panel active" role="tabpanel" aria-labelledby="tab-import-btn">
        <article class="card">
          <header class="card-head">
            <h2 class="card-title">Importar (PipeDict v1)</h2>
            <p class="card-subtitle">Pega tus l√≠neas, valida y guarda.</p>
          </header>

          <form class="form stacked" id="importForm">
            <fieldset class="fieldset">
              <legend class="legend">Datos a importar</legend>

              <div class="control-group">
                <label for="importText" class="label">Entrada</label>
                <textarea id="importText" class="input textarea" rows="10"
                  placeholder="a|s|pa|ps|e1,e2|t  (IDs del diccionario)
# Comentarios con # o //
Ej: k1f3|k1f3|2z9a|2z9a|7s0b,8qmm|t01x"></textarea>
                <small class="help">Formato: PipeDict v1 ¬∑ Se ignoran l√≠neas vac√≠as y comentarios.</small>
              </div>
            </fieldset>

            <div class="action-bar">
              <button id="btnImport" class="btn primary" type="button">Guardar</button>
              <button id="btnClearInput" class="btn ghost" type="button">Limpiar</button>
            </div>
          </form>
        </article>
      </section>

      <!-- FRASES -->
      <section id="tab-frases" class="panel" role="tabpanel" aria-labelledby="tab-frases-btn" hidden>
        <article class="card">
          <header class="card-head">
            <h2 class="card-title">Frases</h2>
          </header>

          <!-- FILTER BAR -->
          <form id="phraseFilters" class="toolbar filterbar" role="search">
            <div class="cluster">
              <div class="input-group grow">
                <label for="q" class="visually-hidden">Buscar</label>
                <input id="q" type="search" class="input" placeholder="Buscar‚Ä¶ (DE/ES/CH/pron)" autocomplete="off" />
              </div>
            </div>

            <div class="cluster wrap">
              <div class="input-group">
                <label for="fTema" class="label">Tema</label>
                <select id="fTema" class="select">
                  <option value="">Todos</option>
                </select>
              </div>

              <div class="input-group">
                <label for="fEstado" class="label">Estado</label>
                <select id="fEstado" class="select">
                  <option value="">Todos</option>
                  <option>nuevo</option>
                  <option>practicada</option>
                  <option>repasada</option>
                  <option>dif√≠cil</option>
                </select>
              </div>

              <div class="input-group">
                <label for="fDificultad" class="label">Dificultad</label>
                <select id="fDificultad" class="select">
                  <option value="">Todas</option>
                  <option>f√°cil</option>
                  <option>normal</option>
                  <option>dif√≠cil</option>
                  <option>√∫til</option>
                </select>
              </div>

              <div class="input-group">
                <label for="fTipo" class="label">Tipo</label>
                <select id="fTipo" class="select">
                  <option value="">Todos</option>
                  <option>afirmaci√≥n</option>
                  <option>pregunta</option>
                  <option>negaci√≥n</option>
                  <option>saludo</option>
                  <option>petici√≥n</option>
                </select>
              </div>
            </div>

            <div class="toolbar-spacer"></div>

            <div class="cluster">
              <button id="btnExportPipeDict" class="btn" type="button">Exportar PipeDict</button>
            </div>
          </form>

          <!-- LIST -->
          <div class="list-wrap">
            <div id="phraseList" class="list" role="feed" aria-busy="false" aria-live="polite"></div>
          </div>
        </article>
      </section>

      <!-- VOCABULARIO -->
      <section id="tab-vocab" class="panel" role="tabpanel" aria-labelledby="tab-vocab-btn" hidden>
        <article class="card">
          <header class="card-head">
            <h2 class="card-title">Vocabulario</h2>
          </header>

          <div class="toolbar">
            <div class="cluster">
              <div class="input-group">
                <label for="vocabMode" class="label">Vista</label>
                <select id="vocabMode" class="select">
                  <option value="es">ES ‚Üí DE</option>
                  <option value="de">DE ‚Üí ES</option>
                </select>
              </div>
            </div>

            <div class="toolbar-spacer"></div>

            <div class="cluster">
              <button id="btnExportVocab" class="btn ghost" type="button">Exportar vocab (simple)</button>
            </div>
          </div>

          <div class="list-wrap">
            <div id="vocabList" class="list" role="list"></div>
          </div>
        </article>
      </section>

      <!-- REPASO -->
      <section id="tab-repaso" class="panel" role="tabpanel" aria-labelledby="tab-repaso-btn" hidden>
        <article class="card">
          <header class="card-head">
            <h2 class="card-title">Repaso</h2>
            <p class="card-subtitle">Tu sesi√≥n inteligente de pr√°ctica.</p>
          </header>

          <div class="empty-state" role="status" aria-live="polite">
            <p>Pr√≥ximamente‚Ä¶</p>
          </div>
        </article>
      </section>
    </main>

    <!-- BOTTOM NAV (mobile) -->
    <footer class="bottombar" role="navigation" aria-label="Navegaci√≥n inferior">
      <button class="tablink active" data-tab="import" aria-controls="tab-import" aria-label="Importar">üì•</button>
      <button class="tablink" data-tab="frases" aria-controls="tab-frases" aria-label="Frases">üìö</button>
      <button class="tablink" data-tab="vocab" aria-controls="tab-vocab" aria-label="Vocabulario">üóÇÔ∏è</button>
      <button class="tablink" data-tab="repaso" aria-controls="tab-repaso" aria-label="Repaso">üîÅ</button>
    </footer>
  </div>

  <!-- SETTINGS DIALOG (skeleton) -->
  <dialog id="settingsDialog" class="dialog" aria-label="Ajustes">
    <form method="dialog" class="dialog-body">
      <header class="dialog-head">
        <h3 class="dialog-title">Ajustes</h3>
      </header>
      <section class="dialog-content">
        <p>Config. pr√≥ximamente.</p>
      </section>
      <footer class="dialog-foot">
        <button value="cancel" class="btn ghost">Cerrar</button>
      </footer>
    </form>
  </dialog>

  <!-- App -->
  <script src="app.js"></script>

  <!-- SW + anti-doble-tap -->
  <script>
    let __lt = 0;
    document.addEventListener('touchend', (e)=>{
      const t = Date.now();
      if (t - __lt < 350) { e.preventDefault(); return; }
      __lt = t;
    }, {passive:false});

    if ('serviceWorker' in navigator) {
      addEventListener('load', () => navigator.serviceWorker.register('./sw.js').catch(console.error));
    }
  </script>
</body>
</html>